# ML Based Self-Active Network Intrusion Detection System

**A Self-Active Learning Framework for Network Intrusion Detection**
 
 
![Status](https://img.shields.io/badge/Status-Research_Project-green)
![Python](https://img.shields.io/badge/Python-3.x-blue)
![Institution](https://img.shields.io/badge/TU-Chemnitz-darkgreen)

## üìÑ Abstract

**SA-IDS** (Self-Active Intrusion Detection System) is a novel framework designed to overcome the scarcity of labeled network traffic data in Machine Learning (ML)-based Intrusion Detection Systems. By adopting a hybrid approach of **Active Learning (AL)** and **Self-Learning**, SA-IDS improves detection performance while significantly reducing the cost and effort required for human labeling.

This framework employs a novel **cluster-based sampling approach** (utilizing HDBSCAN) to facilitate labeling automation, minimizing expert involvement by up to **47%** compared to traditional baselines.

---

## üöÄ Key Features

* **Hybrid Learning Framework:** Combines Self-Learning (Pseudo-labeling high-confidence samples) and Active Learning (Querying Oracle for uncertain samples).
* **Cluster-Based Sampling:** Uses **HDBSCAN** (Hierarchical Density-Based Spatial Clustering) to group informative samples, reducing the number of queries sent to the human expert.
* **Ensemble Detection Engine:** Integrates multiple classifiers (Random Forest, KNN, CNN) to improve stability, generalization, and robustness .
* **Flow-Based Analysis:** Analyzes aggregated network traffic flows (NetFlow) generated by **Argus**, ensuring efficiency and privacy (no payload inspection).
* **Automated Conflict Resolution:** Implements strategies (Homogeneity-based and Majority-based) to handle conflicting labels during the propagation phase .

---

## üõ†Ô∏è Architecture

The SA-IDS framework consists of the following operational modules :

<img width="700" height="390" alt="image" src="https://github.com/user-attachments/assets/0173f592-3623-4791-b26f-b012400756ed" />

1.  **Flow Information Generator (A):**
    * Utilizes the **Argus** tool to process raw packets and generate Network Traffic Flows (NTF).
    * Generates features excluding source/destination IPs to ensure protocol independence.
2.  **Data Preprocessing (B):**
    * Performs data cleaning, numeric encoding, and Min-Max scaling.
    * Selects relevant features based on statistical filtering.
3.  **Detection Engine (C):**
    * **Self-Learning:** Retrains the ensemble model using high-confidence pseudo-labels.
    * **Active Learning:** Identifies uncertain samples using Soft Vote Entropy (SVE).
4.  **Clustering & Candidate Selection (D):**
    * Clusters uncertain samples using **HDBSCAN** with automatic parameter configuration via DBCV scores.
    * Selects representative candidates to query the Oracle.
5.  **Label Propagation (F):**
    * Propagates the Oracle's labels to the specific cluster based on defined conflict resolution rules.

---

## üìä Datasets

The framework was evaluated on two challenging real-world datasets:

| Dataset | Type | Description |
| :--- | :--- | :--- |
| **CTU-13** | Balanced | Contains 13 scenarios with 7 different botnets (Neris, Rbot, Virut, etc.) . |
| **CICIDS2017** | Imbalanced | Contains diverse attacks like DDoS, Port Scan, Infiltration, and Brute Force. |

---

## üíª Implementation & Technologies

* **Language:** Python 3.x
* **Core Libraries:**
    * `scikit-learn` (RF, KNN, SVM, Logistic Regression).
    * `pandas` / `numpy` (Data manipulation).
    * `hdbscan` (Density-based clustering).
    * `tensorflow` / `keras` (CNN implementation).
* **External Tools:**
    * **Argus:** Audit Record Generation and Utilization System for flow generation.

---

## üìÅ Folder structure

Below is a high-level overview of the repository layout and the purpose of the main files and folders. Use this as a quick reference to find scripts, data, notebooks, and results.

- Root & core scripts
    - `active_learner.py`, `active_self_learner.py`, `active_learner_sample_initialize.py`, `AL_test_init_stage.py` ‚Äî main active/self-learning implementation and experiment logic.
    - `script.py`, `script_AL.py`, `script_AL_seq.py`, `script_AL_parallel.py`, `script_AL_seq_individual.py`, `script_AL_seq_load_model.py`, `script_step_1_initialize.py` ‚Äî experiment orchestration and runner scripts.

- Data handling & feature engineering
    - `data_preparation.py`, `data_splitting.py`, `feature_selection.py` ‚Äî data cleaning, feature extraction/selection, and split generation for experiments.

- Model logic & tuning
    - `model_fitter.py`, `model_tuner.py`, `clf_tune.py`, `LR_tuning.py`, `svm_tuning.py` ‚Äî model training, evaluation, and hyperparameter tuning utilities.
    - `param_distribution.yaml`, `best_param_init.txt` ‚Äî tuning configuration and example initial parameters.

- Labeling & algorithm support
    - `unsupervised_labeling.py` ‚Äî cluster-based unsupervised labeling (e.g., HDBSCAN-based flows).
    - `methods.py` ‚Äî shared helper functions and project-wide utilities.

- Models & specialized implementations
    - `CNN/` ‚Äî Convolutional Neural Network model implementation and supporting files (`CNN.py`).

- Notebooks & analysis
    - `Notebooks/` ‚Äî Jupyter notebooks used for exploration, feature selection, labeling demos, and evaluation reports.

- Datasets & splits
    - `SDN_DS/` ‚Äî cleaned SDN dataset CSVs for experiments.
    - `train_test_df/` ‚Äî sample train/test split CSVs (`train_1.csv` ... `test_1.csv`).
    - `complete_all_scenarios_NoTransfer_withHeader_withLabel-26-1-2021-bak.csv` ‚Äî main dataset CSV provided in the repository.

- Outputs, figures & documentation
    - `results/` ‚Äî experiment outputs (reports, CSVs, and `final_results/`).
    - `fig/` ‚Äî figures and visual resources used in the paper and reports.
    - `document/` ‚Äî project documentation and reports (e.g., `Results.md`).

- Configuration & utilities
    - `config_directories.yaml`, `config_directories_2_stage_model.yaml` ‚Äî configuration files for directory structure and model setups.
    - `plotting.py` ‚Äî plotting utilities for generating evaluation visuals.

---

## üìà Results

### Detection Performance
SA-IDS outperformed unsupervised baselines (Isolation Forest, Local Outlier Factor) and matched supervised baselines with significantly fewer labeled samples.

* **CTU-13:** Achieved an **F1-Score of ~0.93**.
* **CICIDS2017:** Achieved competitive accuracy despite high class imbalance.
<img width="1014" height="639" alt="Screenshot 2025-11-30 110319" src="https://github.com/user-attachments/assets/9ba62f14-8b89-4467-884e-8052e882613c" />

<img width="978" height="387" alt="Screenshot 2025-11-30 110250" src="https://github.com/user-attachments/assets/54855003-7b9d-4920-89da-783a722983ad" />


### Labeling Efficiency
* **Reduced Queries:** Significantly reduced the number of queries to the Oracle compared to standard Uncertainty Sampling.
* **Expert Involvement:** Minimized expert intervention by **~47%** compared to baseline Active Learning methods (e.g., AL_CNN).

---

## üìù License
 This work has been performed in the framework of the Celtic-Plus AI-NET PROTECT project, funded by the German BMBF (ID: 16KIS1285).

## Cite this 
https://ieeexplore.ieee.org/abstract/document/10154343

M. Hajizadeh, S. Barua and P. Golchin, "FSA-IDS: A Flow-based Self-Active Intrusion Detection System," NOMS 2023-2023 IEEE/IFIP Network Operations and Management Symposium, Miami, FL, USA, 2023, pp. 1-9, doi: 10.1109/NOMS56928.2023.10154343.

````
@INPROCEEDINGS{10154343,
  author={Hajizadeh, Mehrdad and Barua, Sudip and Golchin, Pegah},
  booktitle={NOMS 2023-2023 IEEE/IFIP Network Operations and Management Symposium}, 
  title={FSA-IDS: A Flow-based Self-Active Intrusion Detection System}, 
  year={2023},
  volume={},
  number={},
  pages={1-9},
  keywords={Training;Performance evaluation;Adaptation models;Costs;Uncertainty;Scalability;Intrusion detection;Intrusion/Anomaly detection;active learning;self-learning;cluster-based sampling;network traffic labeling},
  doi={10.1109/NOMS56928.2023.10154343}}
````
